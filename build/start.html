<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Добро пожаловать</title>
    <meta content="" name="description">
    <meta content="" name="keywords">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <meta content="ie=edge" http-equiv="x-ua-compatible">
    <link rel="stylesheet" href="assets/styles/app.min.css">
    <script src="assets/scripts/bundle.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios@0.12.0/dist/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/lodash@4.13.1/lodash.min.js"></script>
  </head>
  <body>
    <div class="forest">
      <div class="authorization"><a class="authorization__link" href="#">Авторизоваться</a></div>
      <div class="welcome">
        <div class="welcome__content">
          <div class="welcome__img"></div>
          <div class="welcome__text">
            <h2 class="welcome__tilte">Владимир Астахов</h2>
            <h3 class="welcome__about">Личный сайт веб разработчика</h3>
          </div>
          <ul class="social">
            <li class="social__item"><a class="social__item-link" href="#">
                <svg class="social__item-vk social__item-svg">
                  <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="assets/images/sprite/sprite.svg#vk"> </use>
                </svg></a></li>
            <li class="social__item"><a class="social__item-link" href="#">
                <svg class="social__item-git social__item-svg">
                  <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="assets/images/sprite/sprite.svg#github"> </use>
                </svg></a></li>
            <li class="social__item"><a class="social__item-link" href="#">
                <svg class="social__item-in social__item-svg">
                  <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="assets/images/sprite/sprite.svg#in"> </use>
                </svg></a></li>
          </ul>
        </div>
        <nav class="nav">
          <ul class="menu__list">
            <li class="menu__item"><a class="menu__item-link" href="#">Мои работы</a></li>
            <li class="menu__item"><a class="menu__item-link" href="#">Обо мне</a></li>
            <li class="menu__item"><a class="menu__item-link" href="#">Блог</a></li>
          </ul>
        </nav>
      </div>
      <div class="copyrigh">
        <div class="copyrigh__text">  © Владимир Астахов | создано с любовью в LoftSchool | 2016</div>
      </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.20.3/TweenLite.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/91/three.min.js"></script>
    <script type="x-shader/x-vertex" id="vertexShader">
      varying vec2 v_position;
      uniform vec2 u_size;
      uniform vec2 u_resolution;
      attribute vec2 a_pos;
      void main() {
          v_position = (position.xy+1.0)*0.5;
          gl_Position =  vec4(position, 1.0);            
      }
    </script>
    <script type="x-shader/x-fragment" id="fragmentShader">
      uniform float u_time;
      varying vec2 v_position;
      uniform sampler2D u_image;
      uniform sampler2D u_maps;
      uniform vec2 u_mouse;
      uniform float u_dpi;
      uniform vec2 u_resolution;
      
      
      vec2 pos(){
      return vec2(0.0,0.0);
      }
      
      vec4 blend(vec4 bg,vec4 fg){
      vec3 bgm=bg.rgb*bg.a;
      vec3 fgm=fg.rgb*fg.a;
      float ia=1.0-fg.a;
      float a=(fg.a + bg.a * ia);
      vec3 rgb;
      if(a!=0.0){
          rgb=(fgm + bgm * ia) / a;
      }else{
          rgb=vec3(0.0,0.0,0.0);
      }
      return vec4(rgb,a);
      }
      vec2 pixel(){
      return vec2(1.0*1.0)/u_resolution;
      }
      float wave(float x,float freq, float speed){
      return sin(x*freq+((u_time*(3.1415/2.0))*speed));
      }
      vec2 waves(vec2 pos){
      vec4 maps=texture2D(u_maps,pos);
      float mask=maps.r;
      float y=maps.g;
      float y2=pow(y,2.0);
      
      vec2 intensity=vec2(
          0.5-(y2*0.5),
          0.2+(y2*1.8)
      )*pixel();
      
      vec2 waves=vec2(
          wave(y,400.0-(y2*200.0),-0.03), 
          wave(y,400.0-(y2*400.0*0.05),-0.045)
          +wave(y,900.0-(y2*900.0*0.05),-0.05)
          +wave(pos.x,20.0+(y2*20.0*1.5),-0.01)
      );
      return pos+(waves*intensity*mask);
      }
      vec2 depth(vec2 pos){
      vec2 intensity=vec2(0.01,0.01);
      float d=0.05-pow(texture2D(u_maps,pos).b,1.0);
      return pos+(intensity*u_mouse*d);
      }
      
      void main(){
          vec2 pos=v_position.xy;    
          vec2 turbulence=depth(waves(pos));
          vec2 noTurbulence=depth(pos);
          vec4 c=texture2D(u_image,turbulence);
      
          gl_FragColor=vec4(c.rgb,1.0);
      }
    </script>
    <script>
      var container;
      var camera, scene, renderer;
      var uniforms;
      var mouse = {x:0, y:0};
      var loader = new THREE.TextureLoader();
      
      init();
      animate();
      
      function init() {
          container = document.getElementById( 'forest' );
          
          camera = new THREE.Camera();
          //camera = new THREE.PerspectiveCamera(145, window.innerWidth / window.innerHeight, 1, 5000 );
          camera.position.z = 1;
          scene = new THREE.Scene();
          var geometry = new THREE.PlaneBufferGeometry( 2, 2 );
      
          var MyTexture = loader.load( "assets/images/content/water.jpg" );
          var mapTexture = loader.load( "assets/images/content/water-maps.jpg" );
          MyTexture.minFilter = THREE.LinearFilter;
      
          uniforms = {
              u_time: { type: "f", value: 1.0 },
              u_animation: { type: "f", value: 0.0 },
              u_mouse: { type: "v2", value: new THREE.Vector2() },
              u_resolution: { type: "v2", value: new THREE.Vector2() },
              u_size: {type:"v2", value: new THREE.Vector2(MyTexture.width,MyTexture.height) },
              u_image: {value:MyTexture },
              u_maps: {value:mapTexture}
          };
          var material = new THREE.ShaderMaterial( {
              uniforms: uniforms,
              vertexShader: document.getElementById( 'vertexShader' ).textContent,
              fragmentShader: document.getElementById( 'fragmentShader' ).textContent
          } );
          var mesh = new THREE.Mesh( geometry, material );
          scene.add( mesh );
          renderer = new THREE.WebGLRenderer();
          renderer.setPixelRatio( window.devicePixelRatio );
          
          container.appendChild( renderer.domElement );
          onWindowResize();
          window.addEventListener( 'resize', onWindowResize, false );
      }
      function onWindowResize( event ) {
          renderer.setSize( window.innerWidth, window.innerHeight );
          uniforms.u_resolution.value.x = renderer.domElement.width;
          uniforms.u_resolution.value.y = renderer.domElement.height;
          uniforms.u_mouse.value.x = mouse.x;
          uniforms.u_mouse.value.y = mouse.y;
      }
      function animate() {
          requestAnimationFrame( animate );
          render();
      }
      function render() {
          uniforms.u_time.value += 1.0;
          renderer.render( scene, camera );
      }
      
      document.addEventListener('mousemove',function(event){
          TweenLite.to(uniforms.u_mouse.value, 1, {
              x: ((event.pageX / window.innerWidth) - 0.5) * 1.5,
              y: ((event.pageY / window.innerHeight)- 0.5) * 1.5
          })
      })
    </script>
  </body>
</html>